<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>VIP Dashboard â€“ CBE</title>

  <!-- Favicons -->
  <link rel="shortcut icon" href="/favicon.ico"/>
  <link rel="icon" href="/favicon.ico"/>
  <link rel="icon" type="image/png" sizes="48x48" href="/favicon.png"/>
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/>

  <!-- Poppins & FontAwesome -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet"/>
  <script src="https://kit.fontawesome.com/your-kit-code.js" crossorigin="anonymous"></script>

  <style>
    /* RESET & BASE */
    * { margin:0; padding:0; box-sizing:border-box; }
    html { scroll-behavior: smooth; }
    body, html {
      width:100%; height:100%;
      font-family:'Poppins', sans-serif;
      color: var(--text);
      overflow-x:hidden;
      background: var(--bg);
    }
    a { color: var(--gold); text-decoration:none; }
    img { max-width:100%; display:block; }

    /* THEME VARIABLES */
    :root {
      --bg:#000; --text:#fff;
      --gold:#ffd700; --gold-dark:#cca300;
      --overlay:rgba(0,0,0,0.15);
      --glass-bg:rgba(255,255,255,0.05);
    }
    [data-theme="light"]{
      --bg:#f5f5f5; --text:#333;
      --gold:#cca300; --gold-dark:#b58900;
      --overlay:rgba(255,255,255,0.15);
      --glass-bg:rgba(0,0,0,0.05);
    }

    /* THEME TOGGLE */
    #theme-toggle {
      position:fixed; top:20px; left:20px;
      background:none; border:none;
      font-size:1.5rem; cursor:pointer;
      color:var(--text); z-index:10;
    }

    /* NAVIGATION */
    #nav-menu { position:fixed; top:20px; right:20px; z-index:10; }
    #menu-toggle {
      background:none; border:none; cursor:pointer;
      padding:10px; display:flex; flex-direction:column;
      gap:5px; width:40px; height:40px;
      align-items:center; justify-content:center;
    }
    #menu-toggle span {
      width:30px; height:3px; background:var(--gold);
      transition:all .3s ease;
    }
    #menu-toggle.active span:nth-child(1){ transform:rotate(45deg) translate(7px,7px); }
    #menu-toggle.active span:nth-child(2){ opacity:0; }
    #menu-toggle.active span:nth-child(3){ transform:rotate(-45deg) translate(8px,-8px); }
    #menu-list {
      list-style:none; margin:0; padding:20px;
      background:rgba(0,0,0,0.9);
      position:absolute; top:50px; right:-250px;
      width:250px; transition:right .3s ease;
      border:1px solid var(--gold); border-radius:4px;
    }
    #menu-list.active{ right:0; }
    #menu-list li{ margin:10px 0; }
    #menu-list a{ color:#fff; font-weight:500; }
    #menu-list a:hover{ color:var(--gold); }

    /* HERO */
    header {
      padding:120px 20px 60px; text-align:center;
      position:relative;
    }
    header .logo { margin-bottom:20px; }
    header .logo img {
      width:160px; cursor:pointer; transition:transform .3s;
    }
    header .logo img:hover { transform:scale(1.05); }
    header h1 {
      font-size:3.5rem; margin-bottom:.5em;
      line-height:1.1; color:var(--gold);
    }
    header p {
      font-size:1.2rem; margin:0 auto 1.5em;
      max-width:700px; color:var(--text);
    }
    #greeting {
      font-size:2rem; margin-top:1rem; color:var(--text);
      background:var(--glass-bg); padding:.75rem 1.5rem;
      border-radius:8px; display:inline-block;
      box-shadow:0 4px 20px rgba(0,0,0,0.5);
      font-weight:500;
    }

    /* BUTTONS */
    .btn {
      display:inline-block; padding:12px 30px;
      border:2px solid var(--gold); border-radius:4px;
      font-weight:600; transition:.3s;
    }
    .btn-gold { background:var(--gold); color:#000; }
    .btn:hover{ transform:translateY(-2px); }

    /* SLIDE-IN */
    .slide-in {
      opacity:0; transform:translateY(50px);
      transition:all .8s ease-out;
    }
    .slide-in.visible {
      opacity:1; transform:translateY(0);
    }

    /* CARDS GRID */
    main {
      padding:80px 20px; max-width:1000px; margin:auto;
    }
    .cards {
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(280px,1fr));
      gap:20px;
    }
    .card {
      background:var(--glass-bg);
      backdrop-filter:blur(8px);
      border-radius:16px; padding:2rem 1.5rem;
      box-shadow:0 4px 30px rgba(0,0,0,0.5);
      border:1px solid rgba(255,255,255,0.2);
      text-align:center;
    }
    .card h2{ color:var(--gold); font-size:1.8rem; margin-bottom:.5em; }
    .card p { color:#ddd; text-align:left; margin:1rem 0; }
    .card .btn-gold { margin-top:1rem; }

    /* GOLD CHART SECTION */
    #gold-chart {
      padding:40px 20px; max-width:1200px; margin:60px auto;
    }
    #gold-chart h2 {
      text-align:center; color:var(--gold); margin-bottom:20px;
    }
    #tradingview_chart {
      height:600px; border:1px solid rgba(255,255,255,0.2);
      border-radius:8px; overflow:hidden;
    }

    /* FOOTER */
    footer {
      text-align:center; padding:40px 20px;
      background:rgba(0,0,0,0.8); font-size:.9rem;
    }
    footer a{ color:var(--gold); }
  </style>
</head>
<body>

  <!-- Theme toggle -->
  <button id="theme-toggle" aria-label="Toggle theme">ðŸŒž</button>

  <!-- Navigation -->
  <nav id="nav-menu" aria-label="Main navigation">
    <button id="menu-toggle" aria-expanded="false">
      <span></span><span></span><span></span>
    </button>
    <ul id="menu-list">
      <li><a href="index.html">Home</a></li>
      <li><a href="about.html">About</a></li>
      <li><a href="services.html">Services</a></li>
      <li><a href="FAQ.html">FAQ</a></li>
      <li><a href="CBE_apply.html">Apply</a></li>
      <li><a href="CBE_contact.html">Contact</a></li>
    </ul>
  </nav>

  <!-- Hero -->
  <header class="slide-in">
    <div class="logo">
      <a href="index.html"><img src="CBE_logo.png" alt="CBE Logo"/></a>
    </div>
    <h1>Welcome to Your VIP Dashboard</h1>
    <p>Precision Forex, Simplified â€” your exclusive tools await.</p>
    <div id="greeting">Welcome back, Trader!</div>
  </header>

  <!-- Main Cards -->
  <main>
    <div class="cards">
      <div class="card slide-in">
        <h2>Premium Signals</h2>
        <p>View todayâ€™s curated Forex signals with entry, stop, and target levels.</p>
        <a href="signals.html" class="btn btn-gold">Access Signals</a>
      </div>
      <div class="card slide-in">
        <h2>Trade Insights</h2>
        <p>Explore trade rationales, screenshots, and expert analysis.</p>
        <a href="CBE_trade_insights_vip.html" class="btn btn-gold">View Insights</a>
      </div>
      <div class="card slide-in">
        <h2>Trade History</h2>
        <p>Review our performance logs from January through December.</p>
        <a href="CBE_trade_history_vip.html" class="btn btn-gold">View History</a>
      </div>
      <div class="card slide-in">
        <h2>Contact Support</h2>
        <p>Need assistance? Our dedicated support team is here 24/7.</p>
        <a href="mailto:apexincomeoptions@gmail.com" class="btn btn-gold">Get Support</a>
      </div>
    </div>
  </main>

  <!-- Gold Chart Section -->
  <section id="gold-chart" class="slide-in">
    <h2>Gold (XAU/USD) Real-Time Chart</h2>
    <div id="tradingview_chart"></div>
  </section>

  <!-- Footer -->
  <footer>
    Â© 2025 Chukwuemeka Bullion Exchange. All rights reserved.
    <a href="privacy.html">Privacy Policy</a> |
    <a href="terms.html">Terms & Conditions</a>
  </footer>

  <!-- TradingView Widget -->
  <script src="https://s3.tradingview.com/tv.js"></script>
  <script>
    new TradingView.widget({
      container_id: "tradingview_chart",
      width: "100%", height: "100%",
      symbol: "OANDA:XAUUSD", interval: "60",
      timezone: "Etc/UTC", theme: "dark", style: "1",
      locale: "en", toolbar_bg: "#1f1f1f",
      enable_publishing: false, hide_side_toolbar: false,
      allow_symbol_change: true, details: true,
      studies: ["MACD@tv-basicstudies","RSI@tv-basicstudies"],
      withdateranges: true, show_popup_button: true,
      popup_width: "1000", popup_height: "650",
    });
  </script>

  <!-- Supabase + Personalization & UI Scripts -->
  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';
    const SUPA_URL = 'https://dapwpgvnfjcfqqhrpxla.supabase.co';
    const SUPA_KEY = 'YOUR_SUPABASE_ANON_KEY';
    const supabase = createClient(SUPA_URL, SUPA_KEY);

    // â”€â”€â”€ AUTH & APPROVAL GUARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    (async () => {
      // 1. Get the current user
      const { data: { user }, error: userError } = await supabase.auth.getUser();
      if (!user || userError) {
        // not signed in â†’ redirect
        window.location.replace('login.html');
        return;
      }

      // 2. Check their "approved" flag
      const { data: profile, error: profileError } = await supabase
        .from('users')
        .select('approved')
        .eq('id', user.id)
        .single();

      if (profileError || !profile?.approved) {
        // either DB error or not approved â†’ sign out & redirect
        await supabase.auth.signOut();
        window.location.replace('login.html');
        return;
      }

      // 3. Theyâ€™re signed in AND approved â€” fall through to your UI code
    })();

    // Personalize greeting
    (async()=>{
      const { data: { user } } = await supabase.auth.getUser();
      const { data: row } = await supabase
        .from('users').select('name').eq('id', user.id).single();
      const name = row?.name || 'Trader';
      document.getElementById('greeting').textContent = `Welcome back, ${name}!`;
    })();

    // Theme toggle
    const html = document.documentElement;
    const tbtn = document.getElementById('theme-toggle');
    let theme = localStorage.getItem('theme') || 'dark';
    html.setAttribute('data-theme', theme);
    tbtn.textContent = theme === 'dark' ? 'ðŸŒž' : 'ðŸŒœ';
    tbtn.onclick = () => {
      theme = theme === 'dark' ? 'light' : 'dark';
      html.setAttribute('data-theme', theme);
      localStorage.setItem('theme', theme);
      tbtn.textContent = theme === 'dark' ? 'ðŸŒž' : 'ðŸŒœ';
    };

    // Menu toggle
    document.getElementById('menu-toggle').addEventListener('click', function(){
      this.classList.toggle('active');
      const menu = document.getElementById('menu-list');
      menu.classList.toggle('active');
      const expanded = this.getAttribute('aria-expanded') === 'true';
      this.setAttribute('aria-expanded', !expanded);
    });

    // Slide-in animations
    const obs = new IntersectionObserver(entries => {
      entries.forEach(e => {
        if (e.isIntersecting) {
          e.target.classList.add('visible');
          obs.unobserve(e.target);
        }
      });
    }, { threshold: 0.3 });
    document.querySelectorAll('.slide-in').forEach(el => obs.observe(el));
  </script>

  <!-- Smartsupp Live Chat script -->
  <script type="text/javascript">
    var _smartsupp = _smartsupp || {};
    _smartsupp.key = '018a8bbd868518221e725341a7b2601231ec7ce8';
    window.smartsupp||(function(d) {
      var s,c,o=smartsupp=function(){ o._.push(arguments)};o._=[];
      s=d.getElementsByTagName('script')[0];c=d.createElement('script');
      c.type='text/javascript';c.charset='utf-8';c.async=true;
      c.src='https://www.smartsuppchat.com/loader.js?';s.parentNode.insertBefore(c,s);
    })(document);
  </script>

</body>
</html>
