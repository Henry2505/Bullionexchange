<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>VIP Dashboard – Gold Forex Trading</title>

  <!-- BOOTSTRAP & ICONS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet"/>

  <!-- SUPABASE & TRADINGVIEW -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js/dist/umd/supabase.min.js"></script>
  <script src="https://s3.tradingview.com/tv.js"></script>

  <style>
    :root {
      --bg: #111;
      --panel: rgba(20,20,20,0.9);
      --gold: #bfa057;
      --text: #f0f0f0;
      --muted: #666;
    }
    body {
      font-family: 'Poppins', sans-serif;
      background: var(--bg);
      color: var(--text);
      overflow-x: hidden;
    }
    .bg-panel {
      background: var(--panel) !important;
    }
    .text-gold {
      color: var(--gold) !important;
    }
    .btn-gold {
      background-color: var(--gold);
      border-color: var(--gold);
      color: #000;
    }
    .btn-gold:hover {
      background-color: #e6c65d;
    }
    #chart-container {
      width: 100%;
      height: 100vh;
      position: relative;
    }
    @media (max-width: 768px) {
      #chart-container {
        height: 50vh;
      }
    }
    #tv_chart {
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
    }
    .heat-cell {
      flex: 1;
      height: 12px;
      margin: 0 4px;
      background: var(--muted);
    }
  </style>
</head>
<body>

<div class="d-flex">
  <!-- SIDEBAR -->
  <nav class="bg-panel vh-100 p-3 d-none d-md-block" style="width:220px;">
    <div class="text-center mb-4">
      <img src="CBE_logo.PNG" alt="Logo" style="width:120px;cursor:pointer" onclick="location.href='index.html'"/>
    </div>
    <ul class="nav nav-pills flex-column">
      <li class="nav-item"><a class="nav-link active text-light" href="#"><i class="bi-speedometer2 me-2"></i>Dashboard</a></li>
      <li class="nav-item"><a class="nav-link text-light" href="#"><i class="bi-lightning"></i> Signals</a></li>
      <li class="nav-item"><a class="nav-link text-light" href="#"><i class="bi-graph-up"></i> Insights</a></li>
      <li class="nav-item"><a class="nav-link text-light" href="#"><i class="bi-clock-history"></i> History</a></li>
    </ul>
  </nav>

  <!-- MAIN -->
  <div class="flex-fill">
    <!-- HEADER -->
    <header class="bg-panel d-flex justify-content-between align-items-center px-4 py-2 sticky-top">
      <div class="d-flex align-items-center">
        <img src="CBE_logo.PNG" alt="Logo" style="width:40px;cursor:pointer;margin-right:10px;" onclick="location.href='index.html'"/>
        <h5 class="mb-0">Welcome back, <span class="fw-bold text-gold">Gold Trader</span>!</h5>
      </div>
    </header>

    <!-- GOLD MOVEMENT -->
    <div class="container-fluid px-4 mb-4">
      <div class="card bg-panel p-3">
        <h6 class="text-gold">Gold Movement (Last Hour)</h6>
        <p id="gold-movement" class="fs-2 mb-0">0.00</p>
      </div>
    </div>

    <!-- GOLD NEWS -->
    <div class="container-fluid px-4 mb-4">
      <div class="card bg-panel p-3">
        <h6 class="text-gold">Gold Market News</h6>
        <ul id="news-list" class="list-unstyled"></ul>
      </div>
    </div>

    <!-- GOLD PRICE ALERT -->
    <div class="container-fluid px-4 mb-4">
      <div class="card bg-panel p-3">
        <h6 class="text-gold">Set Gold Price Alert</h6>
        <input type="number" id="alert-price" placeholder="Enter target price" class="form-control mb-2"/>
        <button id="set-alert" class="btn btn-gold">Set Alert</button>
      </div>
    </div>

    <!-- GOLD VOLUME HEATMAP -->
    <div class="container-fluid px-4 mb-4">
      <div class="card bg-panel p-3">
        <h6 class="text-gold">Gold Trading Volume Heatmap</h6>
        <div class="d-flex mt-2">
          <div class="heat-cell" id="tokyo"></div>
          <div class="heat-cell" id="london"></div>
          <div class="heat-cell" id="ny"></div>
        </div>
        <div class="d-flex justify-content-between small text-muted mt-1">
          <span>Tokyo</span><span>London</span><span>New York</span>
        </div>
      </div>
    </div>

    <!-- CHART -->
    <div id="chart-container">
      <div id="tv_chart"></div>
    </div>

    <footer class="text-center py-3 text-muted">© 2025 Gold Forex Trading</footer>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // SUPABASE
  const SUPA_URL = 'https://dapwpgvnfjcfqqhrpxla.supabase.co';
  const SUPA_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRhcHdwZ3ZuZmpjZnFxaHJweGxhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDcwNDA4ODgsImV4cCI6MjA2MjYxNjg4OH0.ICC0UsLlzJDNre7rFCeD3k6iVzo6jOJgn3PhABpEMsQ';
  const supabase = window.supabase.createClient(SUPA_URL, SUPA_KEY);

  // CHART
  new TradingView.widget({
    container_id: 'tv_chart',
    width: '100%', height: '100%',
    symbol: 'OANDA:XAUUSD', interval: '60',
    theme: 'dark', style: '1', locale: 'en',
    toolbar_bg: '#000', hide_side_toolbar: false,
    enable_publishing: false, allow_symbol_change: true
  });

  // GOLD MOVEMENT
  function updateGoldMovement() {
    const movement = (Math.random() * 2 - 1).toFixed(2);
    const el = document.getElementById('gold-movement');
    el.textContent = movement;
    el.style.color = movement < -0.10 ? 'hsl(0, 100%, 50%)' : movement <= 0.10 ? 'hsl(60, 100%, 50%)' : 'hsl(120, 100%, 50%)';
  }
  setInterval(updateGoldMovement, 60000);
  updateGoldMovement();

  // NEWS
  const newsData = [
    "Gold prices surge amid economic uncertainty.",
    "Central banks increase gold reserves.",
    "Gold ETF inflows hit record highs."
  ];
  const newsList = document.getElementById('news-list');
  newsData.forEach(news => {
    const li = document.createElement('li');
    li.textContent = news;
    newsList.appendChild(li);
  });

  // ALERTS
  document.getElementById('set-alert').addEventListener('click', () => {
    const target = document.getElementById('alert-price').value;
    if (target) alert(`Alert set for gold price: $${target}`);
  });

  // HEATMAP
  setInterval(() => {
    ['tokyo', 'london', 'ny'].forEach(id => {
      const volume = Math.random();
      const color = volume > 0.7 ? 'hsl(120, 100%, 50%)' : volume > 0.3 ? 'hsl(60, 100%, 50%)' : 'hsl(0, 100%, 50%)';
      document.getElementById(id).style.background = color;
    });
  }, 10000);
</script>
</body>
</html>
