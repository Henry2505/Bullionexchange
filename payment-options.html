<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Payment Options - CBE</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
  <style>
    /* [Insert the full CSS from your original payment-options.html here] */
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background-color: #0b0b0b;
      color: #f5f5f5;
      line-height: 1.6;
    }
    header {
      background: linear-gradient(135deg, #111, #1c1c1c);
      padding: 60px 20px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    /* ... (rest of the CSS remains the same as your original file) ... */
  </style>
</head>
<body>
  <header>
    <h1>Payment Options</h1>
    <p>Complete your payment to activate your VIP subscription</p>
  </header>
  <section id="paymentSection">
    <!-- Payment methods will be dynamically loaded here -->
  </section>
  <footer>
    &copy; 2025 CBE - Chukwuemeka Bullion Exchange. All rights reserved.
  </footer>

  <script>
    (function() {
      const plans = {
        weekly: { price: '$50', duration: 7*24*60*60*1000 },
        monthly: { price: '$150', duration: 30*24*60*60*1000 },
        yearly: { price: '$1,500', duration: 365*24*60*60*1000 }
      };
      const planKey = localStorage.getItem('subscriptionPlan');

      // Fetch payment methods from backend (to be adjusted with your API endpoint)
      fetch('/api/payment-methods')
        .then(response => response.json())
        .then(methods => {
          if (!planKey || !plans[planKey]) {
            alert('No plan selected. Redirecting...');
            window.location.href = 'vip-subscription.html';
            return;
          }
          document.getElementById('planName').textContent = planKey.charAt(0).toUpperCase() + planKey.slice(1);
          document.getElementById('planPrice').textContent = plans[planKey].price;

          const section = document.getElementById('paymentSection');
          section.innerHTML = `
            <div class="summary">
              You have chosen the <span id="planName">[Plan]</span> plan: <span id="planPrice">[Price]</span>
            </div>
          `;

          methods.forEach(method => {
            if (method.method_name.toLowerCase() === 'paystack') {
              const div = document.createElement('div');
              div.className = 'method';
              div.id = 'paystack-method';
              div.innerHTML = `
                <h3>ðŸ’³ Pay with Paystack</h3>
                <button class="glow-button" id="paystackBtn">Proceed to Paystack</button>
              `;
              section.appendChild(div);
              document.getElementById('paystackBtn').addEventListener('click', () => {
                alert('Paystack integration coming soon. Use details: ' + method.details);
              });
            } else if (method.method_name.toLowerCase() === 'bitcoin') {
              const div = document.createElement('div');
              div.className = 'method';
              div.innerHTML = `
                <h3>â‚¿ Pay with Cryptocurrency</h3>
                <div class="wallet-address" id="walletAddress">${method.details}</div>
                <button class="glow-button" id="copyBtn">Copy Wallet Address</button>
                <button class="glow-button" id="cryptoConfirmBtn">I Have Sent Crypto</button>
              `;
              section.appendChild(div);
              document.getElementById('copyBtn').addEventListener('click', () => {
                navigator.clipboard.writeText(method.details).then(() => alert('Address copied!'));
              });
              document.getElementById('cryptoConfirmBtn').addEventListener('click', () => {
                const now = Date.now();
                localStorage.setItem('subscribed', 'true');
                localStorage.setItem('subscriptionEnd', (now + plans[planKey].duration).toString());
                alert('Payment confirmed! Redirecting...');
                window.location.href = 'vip-dashboard.html';
              });
            }
          });

          // Upload proof section
          const uploadDiv = document.createElement('div');
          uploadDiv.className = 'upload-proof';
          uploadDiv.innerHTML = `
            <h3>ðŸ“¤ Upload Proof of Payment</h3>
            <label for="proofFile" class="file-label">Choose File</label>
            <input type="file" id="proofFile" accept="image/*,application/pdf">
            <button class="glow-button" id="uploadProofBtn">Upload Proof</button>
          `;
          section.appendChild(uploadDiv);
          document.getElementById('uploadProofBtn').addEventListener('click', () => {
            const fileIn = document.getElementById('proofFile');
            if (!fileIn.files.length) return alert('Select proof file.');
            alert('Proof uploaded! We will verify shortly.');
          });

          // Expiry check
          const expiry = localStorage.getItem('subscriptionEnd');
          if (expiry && Date.now() > parseInt(expiry, 10)) {
            alert('Your subscription has expired.');
            localStorage.removeItem('subscribed');
            localStorage.removeItem('subscriptionEnd');
            window.location.href = 'login.html';
          }
        })
        .catch(error => console.error('Error fetching payment methods:', error));
    })();
  </script>
  <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'93c9262249ad675b',t:'MTc0NjcwOTMyMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
</body>
</html>
