<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VIP Payment • CBE</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
  <style>
    body { margin:0; font-family:'Poppins',sans-serif; background:#0b0b0b; color:#f5f5f5 }
    .video-background {
      position:fixed; top:0; left:0; width:100%; height:100%;
      object-fit:cover; z-index:-2;
    }
    .overlay {
      position:fixed; top:0; left:0; width:100%; height:100%;
      background:rgba(0,0,0,0.6); z-index:-1;
    }
    .container {
      max-width:700px; margin:120px auto 40px; padding:30px;
      background:rgba(20,20,20,0.8); border-radius:12px;
      box-shadow:0 0 20px gold; text-align:center;
    }
    h1 { color:gold; margin-bottom:10px }
    #planInfo { font-size:18px; margin-bottom:20px }
    input, select {
      width:100%; padding:12px; margin-bottom:20px;
      background:#111; border:1px solid #444; color:#f5f5f5;
      border-radius:6px; font-size:16px;
    }
    .method-select { display:flex; justify-content:center; gap:20px; margin-bottom:20px }
    .method-select button {
      flex:1; min-width:120px; padding:12px; background:gold;
      color:#000; border:none; border-radius:6px; font-weight:bold;
      cursor:pointer; transition:0.3s;
    }
    .method-select button:hover {
      background:#e6c200; box-shadow:0 0 10px gold;
    }
    #cryptoOptions { display:none; margin-bottom:20px }
    .wallet-box {
      display:flex; justify-content:space-between; align-items:center;
      background:#111; padding:10px; border-radius:6px;
    }
    .wallet-box span { color:gold; font-size:14px }
    .wallet-box button {
      padding:6px 12px; background:#333; color:gold; border:none;
      border-radius:5px; cursor:pointer; animation:blinkGlow 2s infinite;
    }
    @keyframes blinkGlow {
      0%,100%{box-shadow:0 0 5px gold}50%{box-shadow:0 0 15px gold}
    }
    .submit-btn button {
      width:100%; padding:14px; background:gold; color:#000;
      border:none; border-radius:8px; font-size:16px; font-weight:bold;
      cursor:pointer; transition:0.3s;
    }
    .submit-btn button:hover {
      background:#e6c200; box-shadow:0 0 10px gold;
    }
    .logo-wrapper { text-align:center; margin-bottom:20px }
    .logo-wrapper a img { height:60px; cursor:pointer }
  </style>
</head>
<body>
  <video class="video-background" autoplay muted loop playsinline>
    <source src="star-video.mp4" type="video/mp4">
  </video>
  <div class="overlay"></div>

  <div class="logo-wrapper">
    <a href="Index.html"><img src="CBE_logo.PNG" alt="CBE Logo"></a>
  </div>

  <div class="container">
    <h1>Complete Your Payment</h1>
    <p id="planInfo">Loading plan…</p>

    <form id="paymentForm">
      <input type="email" id="userEmail" placeholder="Your application email" required />

      <div class="method-select">
        <button type="button" id="paystackBtn">Paystack</button>
        <button type="button" id="cryptoBtn">Crypto</button>
      </div>

      <div id="cryptoOptions">
        <select id="cryptoType">
          <option value="">Select Crypto</option>
          <option value="BTC">BTC</option>
          <option value="Ethereum ERC20">Ethereum ERC20</option>
          <option value="USDT TRC20">USDT TRC20</option>
          <option value="TRX">TRX</option>
        </select>
        <div class="wallet-box">
          <span id="walletAddress">–</span>
          <button type="button" id="copyWalletBtn">Copy</button>
        </div>
      </div>

      <div class="submit-btn">
        <button type="submit">Submit Payment</button>
      </div>
    </form>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    // Immediately run this as soon as the script is parsed:
    (function() {
      const params = new URLSearchParams(window.location.search);
      const plan   = params.get('plan');
      const amount = params.get('amount');
      console.log('DEBUG: URL params → plan=', plan, ', amount=', amount);

      const planNames = {
        weekly:  'Weekly Plan',
        monthly: 'Monthly Plan',
        yearly:  'Yearly Plan'
      };
      const prettyName = planNames[plan] || 'Unknown Plan';

      const planInfoEl = document.getElementById('planInfo');
      if (plan && amount) {
        planInfoEl.textContent = `You chose: ${prettyName} — $${amount}`;
      } else {
        planInfoEl.textContent = 'No subscription plan selected.';
      }

      // Add hidden inputs for POSTing
      const form = document.getElementById('paymentForm');
      form.insertAdjacentHTML('beforeend', `
        <input type="hidden" name="plan"   value="${plan||''}">
        <input type="hidden" name="amount" value="${amount||''}">
      `);
    })();
  </script>
</body>
</html>
