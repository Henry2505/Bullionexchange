<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CBE Admin Panel</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
  <style>
    /* (your existing CSS unchanged) */
  </style>
</head>
<body>
  <!-- Redirect if not authenticated -->
  <script>
    if (sessionStorage.getItem('adminAuthenticated')!=='true') {
      window.location.href='admin-login.html';
    }
  </script>

  <button id="toggleSidebar">⋮</button>
  <video id="bg-video" autoplay muted loop playsinline preload="auto">
    <source src="star-video.MP4" type="video/mp4">
  </video>
  <div id="overlay"></div>

  <div class="container">
    <nav class="sidebar">
      <a href="#" class="active" data-section="dashboard">Dashboard</a>
      <a href="#" data-section="applications">Applications</a>
      <a href="#" data-section="payments">Payments</a>
      <a href="#" data-section="users">Users</a>
      <a href="#" data-section="trades">Trades</a>
      <a href="#" data-section="signals">Signals</a>
      <a href="#" data-section="broadcasts">Broadcasts</a>
      <a href="#" data-section="inbox">Inbox</a>
      <a href="#" data-section="settings">Settings</a>
      <a href="#" data-section="logs">Logs</a>
      <div class="spacer"></div>
      <a href="index.html" target="_blank">View Site</a>
      <a href="admin-login.html" class="btn danger">Logout</a>
    </nav>

    <div class="content">
      <!-- Dashboard -->
      <section id="dashboard">
        <h2>Overview</h2>
        <div class="cards">…</div>
      </section>

      <!-- Applications -->
      <section id="applications" class="hidden">
        <h2>Applications</h2>
        <table>
          <thead>
            <tr>
              <th>Name</th><th>Email</th><th>Phone</th>
              <th>Message</th><th>Date</th><th>Status</th><th>Actions</th>
            </tr>
          </thead>
          <tbody id="applications-list"></tbody>
        </table>
      </section>

      <!-- Payments -->
      <section id="payments" class="hidden">…</section>
      <!-- Users -->
      <section id="users" class="hidden">…</section>
      <!-- Trades -->
      <section id="trades" class="hidden">…</section>
      <!-- Signals -->
      <section id="signals" class="hidden">…</section>
      <!-- Broadcasts -->
      <section id="broadcasts" class="hidden">…</section>
      <!-- Inbox -->
      <section id="inbox" class="hidden">…</section>
      <!-- Settings -->
      <section id="settings" class="hidden">…</section>
      <!-- Logs -->
      <section id="logs" class="hidden">…</section>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Sidebar toggle
      document.getElementById('toggleSidebar').addEventListener('click', ()=>
        document.body.classList.toggle('collapsed-sidebar')
      );

      // Tab‐switching
      document.querySelectorAll('.sidebar a[data-section]').forEach(a=>{
        a.addEventListener('click', e=>{
          e.preventDefault();
          document.querySelectorAll('.sidebar a').forEach(x=>x.classList.remove('active'));
          a.classList.add('active');
          const sec = a.dataset.section;
          document.querySelectorAll('.content section').forEach(s=>{
            s.id===sec? s.classList.remove('hidden'): s.classList.add('hidden');
          });
        });
      });

      // Load Applications
      const apps = JSON.parse(localStorage.getItem('applications')||'[]');
      const tbody = document.getElementById('applications-list');
      apps.forEach((app,idx) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${app.name}</td>
          <td>${app.email}</td>
          <td>${app.phone}</td>
          <td>${app.message}</td>
          <td>${new Date(app.date).toLocaleString()}</td>
          <td id="status-${idx}">${app.status}</td>
          <td>
            <button class="btn small" data-action="approve" data-id="${idx}">Approve</button>
            <button class="btn danger small" data-action="decline" data-id="${idx}">Decline</button>
          </td>`;
        tbody.appendChild(tr);
      });

      // Approve/Decline handlers
      tbody.addEventListener('click', e => {
        if (e.target.tagName==='BUTTON') {
          const id = e.target.dataset.id;
          const action = e.target.dataset.action;
          let list = JSON.parse(localStorage.getItem('applications')||'[]');
          list[id].status = action==='approve' ? 'approved' : 'declined';
          localStorage.setItem('applications', JSON.stringify(list));
          document.getElementById(`status-${id}`).textContent = list[id].status;
        }
      });

      // (other preview/image scripts…)
    });

    // Redirect if not authenticated
    if (sessionStorage.getItem('adminAuthenticated')!=='true') {
      window.location.href='admin-login.html';
    }
  </script>
</body>
</html>
