<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Panel – CBE</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
  <style>
    /* Base */
    body, html {
      margin: 0; padding: 0;
      font-family: 'Poppins', sans-serif;
      background: #0b0b0b;
      color: #f5f5f5;
      overflow-x: hidden;
    }
    a { color: gold; text-decoration: none; }
    a:hover { text-decoration: underline; }

    /* Password Modal */
    #pwModal {
      position: fixed; top:0; left:0; width:100%; height:100%;
      background: rgba(0,0,0,0.85); z-index: 2000;
      display: flex; justify-content: center; align-items: center;
    }
    #pwModal .box {
      background: #141414; padding: 30px; border-radius: 8px;
      text-align: center; box-shadow: 0 0 20px rgba(255,215,0,0.3);
    }
    #pwModal input {
      width: 200px; padding: 10px; margin-top: 15px;
      border: 1px solid #333; border-radius: 4px;
      background: #1c1c1c; color: #f5f5f5;
    }
    #pwModal button {
      margin-top: 20px; padding: 10px 20px;
      background: gold; border: none; color: #000;
      cursor: pointer; border-radius: 4px;
    }

    /* Header */
    header {
      background: #000; padding: 20px; position: relative;
      box-shadow: 0 2px 6px rgba(0,0,0,0.5);
      text-align: center; font-size: 1.4rem; color: gold;
    }
    #backHome {
      position: absolute; left: 20px; top: 20px;
      font-size: 0.9rem;
    }

    /* Toggle Button */
    .menu-toggle {
      position: absolute; top: 18px; right: 20px;
      width: 36px; height: 36px; background: gold;
      border: none; border-radius: 50%; cursor: pointer;
      animation: blink 2s infinite;
    }
    @keyframes blink {
      0%,100%{box-shadow:0 0 6px gold}50%{box-shadow:0 0 18px gold}
    }
    .menu-toggle span {
      display: block; width: 6px; height: 6px;
      background: #000; margin: 4px auto;
      border-radius: 50%;
    }

    /* Sidebar */
    .sidebar {
      width: 200px; background: #111; position: fixed;
      top: 0; left: -200px; height: 100%; padding-top: 80px;
      transition: left 0.3s; box-shadow: 2px 0 6px rgba(0,0,0,0.5);
      z-index: 1000;
    }
    .sidebar.active { left: 0; }
    .sidebar a {
      display: block; padding: 12px 20px;
      border-bottom: 1px solid #222;
    }

    /* Main Content */
    .main {
      margin-left: 0; transition: margin-left 0.3s;
      padding: 100px 30px 30px 30px;
    }
    .main.shifted { margin-left: 200px; }

    /* Section Boxes */
    .section {
      background: #1a1a1a; margin-bottom: 30px;
      padding: 20px; border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
    }
    .section h2 { margin-top: 0; color: gold; }

    /* Record Box */
    .record-box, .insight-box {
      background:#141414; padding:15px; margin-bottom:15px;
      border-radius:6px; position: relative;
    }
    .record-box img, .insight-box img {
      max-width:100%; border-radius:4px; pointer-events:none;
    }
    .record-box button, .insight-box button {
      background: crimson; color:#fff; border:none;
      padding:6px 10px; border-radius:4px; cursor:pointer;
      position:absolute; top:10px; right:10px;
    }
  </style>
</head>
<body>

  <!-- Password Modal -->
  <div id="pwModal">
    <div class="box">
      <h3>Enter Admin Password</h3>
      <input type="password" id="adminPw" placeholder="Password" />
      <br>
      <button onclick="checkPw()">Unlock</button>
    </div>
  </div>

  <!-- Header -->
  <header>
    <a id="backHome" href="index.html">← Back to Site</a>
    CBE Admin Panel
    <button class="menu-toggle" onclick="toggleMenu()">
      <span></span><span></span><span></span>
    </button>
  </header>

  <!-- Sidebar -->
  <nav class="sidebar" id="adminSidebar">
    <a href="#users">Users</a>
    <a href="#payments">Payments</a>
    <a href="#insights">Trade Insights</a>
    <a href="#history">Trade History</a>
    <a href="#signals">Signals</a>
    <a href="#broadcast">Broadcasts</a>
    <a href="#messages">Inbox</a>
    <a href="#settings">Settings</a>
    <a href="#logs">Logs</a>
  </nav>

  <!-- Main -->
  <div class="main" id="adminMain">
    <!-- USERS -->
    <div class="section" id="users">
      <h2>Users</h2>
      <div id="userContainer"></div>
    </div>

    <!-- PAYMENTS -->
    <div class="section" id="payments">
      <h2>Payment Records</h2>
      <div id="paymentContainer"></div>
    </div>

    <!-- TRADE INSIGHTS -->
    <div class="section" id="insights">
      <h2>Trade Insights</h2>
      <div id="insightContainer"></div>
    </div>

    <!-- TRADE HISTORY -->
    <div class="section" id="history">
      <h2>Trade History</h2>
      <div id="historyContainer"></div>
    </div>

    <!-- SIGNALS -->
    <div class="section" id="signals">
      <h2>Signals</h2>
      <div id="signalContainer"></div>
    </div>
        <!-- BROADCASTS -->
    <div class="section" id="broadcast">
      <h2>Broadcast Message</h2>
      <textarea id="broadcastText" rows="4" style="width:100%;"></textarea>
      <button onclick="broadcastMessage()">Send</button>
    </div>

    <!-- INBOX -->
    <div class="section" id="messages">
      <h2>Inbox Messages</h2>
      <div id="inboxContainer"></div>
    </div>

    <!-- SETTINGS -->
    <div class="section" id="settings">
      <h2>Settings</h2>
      <form id="settingsForm">
        <input type="text" id="btc" placeholder="Bitcoin Address" /><br>
        <input type="text" id="eth" placeholder="Ethereum Address" /><br>
        <input type="text" id="usdt" placeholder="USDT Address" /><br>
        <input type="text" id="paystackKey" placeholder="Paystack Public Key" /><br>
        <button type="submit">Save</button>
      </form>
    </div>

    <!-- LOGS -->
    <div class="section" id="logs">
      <h2>Admin Logs</h2>
      <div id="logContainer"></div>
    </div>
  </div>

  <script>
    // Password Protection
    function checkPw() {
      const pw = document.getElementById('adminPw').value;
      if (pw === 'Blessed@123') {
        sessionStorage.setItem('adminAuth','true');
        document.getElementById('pwModal').style.display='none';
      } else {
        alert('Incorrect password.');
      }
    }
    if (sessionStorage.getItem('adminAuth')!=='true') {
      document.getElementById('adminMain').style.display='none';
      document.getElementById('adminSidebar').style.display='none';
    } else {
      document.getElementById('pwModal').style.display='none';
    }

    // Sidebar Toggle
    function toggleMenu() {
      document.getElementById('adminSidebar').classList.toggle('active');
      document.getElementById('adminMain').classList.toggle('shifted');
    }

    // USERS
    function loadUsers() {
      const users = JSON.parse(localStorage.getItem('users')||'[]'),
            c = document.getElementById('userContainer');
      c.innerHTML = users.length
        ? users.map((u,i)=>`
            <div class="record-box">
              <p><strong>${u.name}</strong> (${u.email})</p>
              <p>Status: ${u.status||'pending'}</p>
              <button onclick="approveUser(${i})">Approve</button>
              <button onclick="deactivateUser(${i})">Deactivate</button>
              <button onclick="deleteUser(${i})">Delete</button>
            </div>`
          ).join('')
        : '<p>No users yet.</p>';
    }
    function approveUser(i){let u=JSON.parse(localStorage.getItem('users'));u[i].status='approved';localStorage.setItem('users',JSON.stringify(u));loadUsers();}
    function deactivateUser(i){let u=JSON.parse(localStorage.getItem('users'));u[i].status='inactive';localStorage.setItem('users',JSON.stringify(u));loadUsers();}
    function deleteUser(i){let u=JSON.parse(localStorage.getItem('users'));u.splice(i,1);localStorage.setItem('users',JSON.stringify(u));loadUsers();}

    // PAYMENTS
    function loadPayments() {
      const r=JSON.parse(localStorage.getItem('paymentRecords')||'[]'),
            c=document.getElementById('paymentContainer');
      c.innerHTML = r.length
        ? r.map((p,i)=>`
            <div class="record-box">
              <p><strong>${p.email}</strong> – ${p.plan}</p>
              <p>Status: ${p.status}</p>
              <button onclick="approvePayment(${i})">Approve</button>
            </div>`
          ).join('')
        : '<p>No payments yet.</p>';
    }
    function approvePayment(i){
      let r=JSON.parse(localStorage.getItem('paymentRecords')),
          u=JSON.parse(localStorage.getItem('users')||'[]');
      r[i].status='approved';localStorage.setItem('paymentRecords',JSON.stringify(r));
      const idx=u.findIndex(x=>x.email===r[i].email);
      if(idx>=0){u[idx].status='approved';localStorage.setItem('users',JSON.stringify(u));loadUsers();}
      loadPayments();
    }

    // TRADE INSIGHTS
    function loadInsights() {
      const a=JSON.parse(localStorage.getItem('tradeInsights')||'[]'),
            c=document.getElementById('insightContainer');
      c.innerHTML = a.length
        ? a.map((it,i)=>`
            <div class="insight-box">
              <img src="${it.image}" alt="Insight"/>
              <button onclick="deleteInsight(${i})">Delete</button>
              <p><strong>${it.date}</strong></p>
              <p>${it.note}</p>
            </div>`
          ).join('')
        : '<p>No insights yet.</p>';
    }
    function deleteInsight(i){let a=JSON.parse(localStorage.getItem('tradeInsights')||'[]');
      if(confirm('Delete this insight?')){a.splice(i,1);localStorage.setItem('tradeInsights',JSON.stringify(a));loadInsights();}
    }

    // TRADE HISTORY
    function loadHistory() {
      const a=JSON.parse(localStorage.getItem('tradeHistory')||'[]'),
            c=document.getElementById('historyContainer');
      c.innerHTML = a.length
        ? a.map((h,i)=>`
            <div class="insight-box">
              <img src="${h.image}" alt="History"/>
              <button onclick="deleteHistory(${i})">Delete</button>
              <p><strong>${h.date}</strong></p>
              <p>${h.note}</p>
            </div>`
          ).join('')
        : '<p>No history yet.</p>';
    }
    function deleteHistory(i){let a=JSON.parse(localStorage.getItem('tradeHistory')||'[]');
      if(confirm('Delete this record?')){a.splice(i,1);localStorage.setItem('tradeHistory',JSON.stringify(a));loadHistory();}
    }

    // SIGNALS
    function loadSignals() {
      const a=JSON.parse(localStorage.getItem('vipSignals')||'[]'),
            c=document.getElementById('signalContainer');
      c.innerHTML = a.length
        ? a.map((s,i)=>`
            <div class="insight-box">
              <p><strong>${s.date} ${s.time}</strong></p>
              <p>${s.direction} ${s.pair} @ ${s.entry}</p>
              <p>TP: ${s.tp}  SL: ${s.sl}</p>
              <p><em>${s.note}</em></p>
              <button onclick="deleteSignal(${i})">Delete</button>
            </div>`
          ).join('')
        : '<p>No signals published.</p>';
    }
    function deleteSignal(i){let a=JSON.parse(localStorage.getItem('vipSignals')||'[]');
      if(confirm('Delete this signal?')){a.splice(i,1);localStorage.setItem('vipSignals',JSON.stringify(a));loadSignals();}
    }

    // BROADCAST
    function broadcastMessage(){
      const msg=document.getElementById('broadcastText').value.trim();
      if(!msg) return alert('Enter a message.');
      localStorage.setItem('broadcastMessage',msg);
      alert('Broadcast saved.');
      document.getElementById('broadcastText').value='';
    }

    // INBOX
    function loadInbox(){
      const a=JSON.parse(localStorage.getItem('inboxMessages')||'[]'),
            c=document.getElementById('inboxContainer');
      c.innerHTML = a.length
        ? a.map(m=>`
            <div class="record-box">
              <p><strong>${m.name}</strong> (${m.email})</p>
              <p>${m.message}</p>
            </div>`
          ).join('')
        : '<p>No messages.</p>';
    }

    // SETTINGS
    document.getElementById('settingsForm').addEventListener('submit', e=>{
      e.preventDefault();
      const obj={
        btc:document.getElementById('btc').value.trim(),
        eth:document.getElementById('eth').value.trim(),
        usdt:document.getElementById('usdt').value.trim(),
        paystackKey:document.getElementById('paystackKey').value.trim()
      };
      localStorage.setItem('paymentSettings',JSON.stringify(obj));
      alert('Settings saved.');
    });

    // LOGS
    function log(msg){
      const arr=JSON.parse(localStorage.getItem('adminLogs')||'[]');
      arr.push(`${new Date().toLocaleString()}: ${msg}`);
      localStorage.setItem('adminLogs',JSON.stringify(arr));
    }
    function loadLogs(){
      const a=JSON.parse(localStorage.getItem('adminLogs')||'[]'),
            c=document.getElementById('logContainer');
      c.innerHTML = a.length
        ? a.map(l=>`<p>${l}</p>`).join('')
        : '<p>No logs yet.</p>';
    }

    // Initialize
    window.addEventListener('load', ()=>{
      if(sessionStorage.getItem('adminAuth')==='true'){
        document.getElementById('adminSidebar').style.display='block';
        document.getElementById('adminMain').style.display='block';
        loadUsers(); loadPayments(); loadInsights(); loadHistory();
        loadSignals(); loadInbox(); loadLogs();
      }
    });
  </script>
</body>
</html>
