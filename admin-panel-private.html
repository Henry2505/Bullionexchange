<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Panel</title>
  <!-- Include your CSS and any required libraries here -->
</head>
<body>
  <!-- Your existing HTML structure for the admin panel -->

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-analytics-compat.js"></script>

  <script>
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyDW5MAHUa8ixjtQU-ccOexinkzaVhMFGwc",
      authDomain: "apex-income-options.firebaseapp.com",
      projectId: "apex-income-options",
      storageBucket: "apex-income-options.appspot.com",
      messagingSenderId: "1097313441508",
      appId: "1:1097313441508:web:e789f7a217e05e93293ef1",
      measurementId: "G-4SLZQEWEMP"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();

    const auth = firebase.auth();
    const db = firebase.firestore();
    const storage = firebase.storage();

    // Authentication state observer
    auth.onAuthStateChanged(user => {
      if (user) {
        // User is signed in
        // Check if user is approved
        db.collection('users').doc(user.uid).get().then(doc => {
          if (doc.exists && doc.data().approved) {
            // Load admin panel
          } else {
            // Show not approved message
          }
        });
      } else {
        // No user is signed in
        // Show login form
      }
    });

    // File upload handling
    function uploadFile(file) {
      const storageRef = storage.ref('uploads/' + file.name);
      const uploadTask = storageRef.put(file);

      uploadTask.on('state_changed',
        (snapshot) => {
          // Progress function
          const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
          console.log('Upload is ' + progress + '% done');
        },
        (error) => {
          // Error function
          console.error('Upload failed:', error);
        },
        () => {
          // Complete function
          uploadTask.snapshot.ref.getDownloadURL().then((downloadURL) => {
            console.log('File available at', downloadURL);
            // Save file info to Firestore or update UI accordingly
          });
        }
      );
    }

    // Data synchronization example
    db.collection('signals').onSnapshot(snapshot => {
      snapshot.docChanges().forEach(change => {
        if (change.type === 'added') {
          // Add new signal to UI
        }
        if (change.type === 'modified') {
          // Update existing signal in UI
        }
        if (change.type === 'removed') {
          // Remove signal from UI
        }
      });
    });

    // Navigation and three-dot menu functionality
    document.querySelectorAll('.three-dot-menu').forEach(menu => {
      menu.addEventListener('click', () => {
        // Toggle menu visibility
        const dropdown = menu.nextElementSibling;
        dropdown.classList.toggle('show');
      });
    });

    // Additional functions to handle navigation and other UI interactions
  </script>
</body>
</html>
