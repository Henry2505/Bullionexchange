<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CBE Admin Panel</title>
  <!-- Bootstrap 5 CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <style>
    body { overflow-x: hidden; }
    #sidebar {
      min-width: 250px; max-width: 250px;
      transition: all 0.3s;
      background: #111; color: #f5f5f5; height: 100vh;
    }
    #sidebar.collapsed { margin-left: -250px; }
    #sidebar .nav-link { color: #bbb; }
    #sidebar .nav-link.active,
    #sidebar .nav-link:hover {
      background: #222; color: #fff;
    }
    #content { width: 100%; padding: 1.5rem; transition: margin-left .3s; }
    #toggle-btn { cursor: pointer; font-size: 1.5rem; color: #333; }
    .badge-status { width: 80px; text-align: center; }
  </style>
</head>
<body>
  <div class="d-flex">
    <!-- Sidebar -->
    <nav id="sidebar" class="bg-dark">
      <div class="p-3">
        <h4 class="text-center">CBE Admin</h4>
        <ul class="nav nav-pills flex-column mt-4" id="menu">
          <li class="nav-item"><a class="nav-link active" data-section="dashboard" href="#">Dashboard</a></li>
          <li class="nav-item"><a class="nav-link" data-section="users" href="#">Users</a></li>
          <li class="nav-item"><a class="nav-link" data-section="payments" href="#">Payments</a></li>
          <li class="nav-item"><a class="nav-link" data-section="messages" href="#">Messages</a></li>
          <li class="nav-item"><a class="nav-link" data-section="settings-payment" href="#">Payment Settings</a></li>
          <li class="nav-item"><a class="nav-link" data-section="trade-history" href="#">Trade History</a></li>
          <li class="nav-item"><a class="nav-link" data-section="trade-insights" href="#">Trade Insights</a></li>
          <li class="nav-item"><a class="nav-link" data-section="signals" href="#">Signals</a></li>
          <li class="nav-item mt-auto"><a class="nav-link text-danger" href="#">Logout</a></li>
        </ul>
      </div>
    </nav>

    <!-- Page Content -->
    <div id="content">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div id="toggle-btn">&#8942;</div>
        <h2 id="section-title">Dashboard</h2>
      </div>
      <div id="sections">
        <!-- Dashboard -->
        <div class="section" data-section="dashboard">
          <p>Welcome, <strong>Admin</strong>. Use the menu to manage the site.</p>
        </div>

        <!-- Users Verification -->
        <div class="section d-none" data-section="users">
          <h4>Users Verification</h4>
          <input class="form-control mb-2" id="user-search" placeholder="Search users…" />
          <table class="table table-hover">
            <thead>
              <tr><th>Email</th><th>Name</th><th>Status</th><th>Action</th></tr>
            </thead>
            <tbody id="users-table">
              <!-- populated by JS -->
            </tbody>
          </table>
        </div>

        <!-- Payments Approval -->
        <div class="section d-none" data-section="payments">
          <h4>Payment Approval</h4>
          <button class="btn btn-sm btn-outline-secondary mb-2" id="export-payments">Export CSV</button>
          <table class="table table-hover">
            <thead>
              <tr><th>User</th><th>Amount</th><th>Date</th><th>Status</th><th>Action</th></tr>
            </thead>
            <tbody id="payments-table">
              <!-- populated by JS -->
            </tbody>
          </table>
        </div>

        <!-- Messages -->
        <div class="section d-none" data-section="messages">
          <h4>Contact Messages</h4>
          <input class="form-control mb-2" id="msg-search" placeholder="Search messages…" />
          <div class="list-group" id="messages-list">
            <!-- populated by JS -->
          </div>
        </div>

        <!-- Payment Settings -->
        <div class="section d-none" data-section="settings-payment">
          <h4>Payment Settings</h4>
          <ul class="nav nav-pills mb-3" id="payset-tabs">
            <li class="nav-item"><button class="nav-link active" data-bs-toggle="pill" data-bs-target="#paystack-tab">Paystack</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="pill" data-bs-target="#crypto-tab">Crypto</button></li>
          </ul>
          <div class="tab-content">
            <!-- Paystack -->
            <div class="tab-pane fade show active" id="paystack-tab">
              <form id="form-paystack">
                <div class="mb-3">
                  <label class="form-label">Public Key</label>
                  <input type="text" class="form-control" id="ps-public" placeholder="pk_live_..." />
                </div>
                <div class="mb-3">
                  <label class="form-label">Secret Key</label>
                  <input type="text" class="form-control" id="ps-secret" placeholder="sk_live_..." />
                </div>
                <button class="btn btn-primary">Save Paystack</button>
              </form>
            </div>
            <!-- Crypto -->
            <div class="tab-pane fade" id="crypto-tab">
              <form id="form-crypto">
                <div class="mb-3">
                  <label class="form-label">Bitcoin (BTC) Address</label>
                  <input type="text" class="form-control" id="addr-btc" />
                </div>
                <div class="mb-3">
                  <label class="form-label">Ethereum (ERC20) Address</label>
                  <input type="text" class="form-control" id="addr-eth" />
                </div>
                <div class="mb-3">
                  <label class="form-label">Tron (TRX) Address</label>
                  <input type="text" class="form-control" id="addr-trx" />
                </div>
                <div class="mb-3">
                  <label class="form-label">USDT (TRC20) Address</label>
                  <input type="text" class="form-control" id="addr-usdt" />
                </div>
                <button class="btn btn-primary">Save Crypto</button>
              </form>
            </div>
          </div>
        </div>

        <!-- Trade History -->
        <div class="section d-none" data-section="trade-history">
          <h4>Trade History (Jan – Dec)</h4>
          <div class="row mb-3">
            <div class="col-auto">
              <select id="month-select" class="form-select">
                <option value="01">January</option><option value="02">February</option><!-- … -->
                <option value="12">December</option>
              </select>
            </div>
            <div class="col-auto">
              <button class="btn btn-outline-secondary" id="export-history">Export Month</button>
            </div>
          </div>
          <table class="table table-striped">
            <thead><tr><th>Date</th><th>Pair</th><th>Notes</th><th>Screenshot</th></tr></thead>
            <tbody id="history-table"></tbody>
          </table>
        </div>

        <!-- Trade Insights -->
        <div class="section d-none" data-section="trade-insights">
          <h4>Weekly Pips Insights</h4>
          <form id="insights-form" class="row g-3 mb-4">
            <div class="col-md-4">
              <label class="form-label">Week Ending</label>
              <input type="date" id="insight-week" class="form-control" />
            </div>
            <div class="col-md-4">
              <label class="form-label">Pips Gained</label>
              <input type="number" id="insight-pips" class="form-control" placeholder="e.g. 120" />
            </div>
            <div class="col-md-4 align-self-end">
              <button class="btn btn-success">Post Insight</button>
            </div>
          </form>
          <ul class="list-group" id="insights-list"></ul>
        </div>

        <!-- Signals Publishing -->
        <div class="section d-none" data-section="signals">
          <h4>Publish Signals</h4>
          <form id="signals-form" class="mb-4">
            <div class="row g-3">
              <div class="col-md-3">
                <label class="form-label">Signal Type</label>
                <select id="signal-type" class="form-select">
                  <option>Gold</option>
                  <option>Silver</option>
                  <option>Forex</option>
                  <!-- add as needed -->
                </select>
              </div>
              <div class="col-md-2">
                <label class="form-label">SL</label>
                <input type="text" id="signal-sl" class="form-control" placeholder="e.g. 1900" />
              </div>
              <div class="col-md-2">
                <label class="form-label">TP1</label>
                <input type="text" id="signal-tp1" class="form-control" placeholder="e.g. 1920" />
              </div>
              <div class="col-md-2">
                <label class="form-label">TP2</label>
                <input type="text" id="signal-tp2" class="form-control" placeholder="e.g. 1940" />
              </div>
              <div class="col-md-3">
                <label class="form-label">Note</label>
                <textarea id="signal-note" class="form-control" rows="2"
                  placeholder="Money management rules, risk advice…"></textarea>
              </div>
            </div>
            <div class="mt-3">
              <button class="btn btn-primary">Publish Signal</button>
            </div>
          </form>
          <ul class="list-group" id="signals-list"></ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Reply Modal -->
  <div class="modal fade" id="replyModal" tabindex="-1">
    <div class="modal-dialog">
      <form class="modal-content" id="reply-form">
        <div class="modal-header">
          <h5 class="modal-title">Reply to Message</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <input type="hidden" id="reply-email" />
          <div class="mb-3">
            <label class="form-label">To</label>
            <input type="email" id="reply-to" class="form-control" readonly />
          </div>
          <div class="mb-3">
            <label class="form-label">Message</label>
            <textarea id="reply-body" class="form-control" rows="4"></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-success">Send Reply</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Bootstrap & JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Sidebar toggle
    document.getElementById('toggle-btn').onclick = () =>
      document.getElementById('sidebar').classList.toggle('collapsed');

    // Menu nav
    document.querySelectorAll('#menu .nav-link').forEach(link => {
      link.addEventListener('click', e => {
        e.preventDefault();
        document.querySelectorAll('#menu .nav-link').forEach(l=>l.classList.remove('active'));
        link.classList.add('active');
        const sec = link.dataset.section;
        document.getElementById('section-title').textContent = link.textContent;
        document.querySelectorAll('.section').forEach(s=>
          s.classList.toggle('d-none', s.dataset.section !== sec)
        );
      });
    });

    // Placeholder data & functions (replace with AJAX)
    const usersTable = document.getElementById('users-table');
    const paymentsTable = document.getElementById('payments-table');
    const messagesList = document.getElementById('messages-list');

    // Example entries
    const users = [
      {email:'john@example.com',name:'John',status:'Pending'},
      {email:'jane@example.com',name:'Jane',status:'Verified'}
    ];
    const payments = [
      {user:'john@example.com',amount:'$150',date:'2025-05-18',status:'Pending'}
    ];
    const messages = [
      {email:'foo@bar.com',text:'Help me trade gold.'}
    ];

    function renderUsers() {
      usersTable.innerHTML = '';
      users.forEach(u => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${u.email}</td>
          <td>${u.name}</td>
          <td><span class="badge badge-status bg-${
            u.status==='Verified'?'success':'warning'}">${u.status}</span></td>
          <td>
            <button class="btn btn-sm btn-success">Verify</button>
            <button class="btn btn-sm btn-danger">Reject</button>
          </td>`;
        usersTable.appendChild(tr);
      });
    }
    function renderPayments() {
      paymentsTable.innerHTML = '';
      payments.forEach(p => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${p.user}</td><td>${p.amount}</td><td>${p.date}</td>
          <td><span class="badge badge-status bg-warning">${p.status}</span></td>
          <td>
            <button class="btn btn-sm btn-success">Approve</button>
            <button class="btn btn-sm btn-danger">Decline</button>
          </td>`;
        paymentsTable.appendChild(tr);
      });
    }
    function renderMessages() {
      messagesList.innerHTML = '';
      messages.forEach((m,i) => {
        const a = document.createElement('a');
        a.className = 'list-group-item list-group-item-action d-flex justify-content-between align-items-center';
        a.innerHTML = `<div>
                         <strong>${m.email}</strong><br /><small>${m.text}</small>
                       </div>
                       <button class="btn btn-sm btn-primary" data-index="${i}" data-bs-toggle="modal" data-bs-target="#replyModal">Reply</button>`;
        messagesList.appendChild(a);
      });
    }

    // handle reply modal
    document.getElementById('messages-list').addEventListener('click', e => {
      if (e.target.matches('button')) {
        const idx = e.target.dataset.index;
        document.getElementById('reply-to').value = messages[idx].email;
        document.getElementById('reply-email').value = messages[idx].email;
      }
    });
    document.getElementById('reply-form').addEventListener('submit', e => {
      e.preventDefault();
      // send reply via backend
      const to = e.target.querySelector('#reply-email').value;
      const body = e.target.querySelector('#reply-body').value;
      console.log('Reply to', to, 'message:', body);
      bootstrap.Modal.getInstance(document.getElementById('replyModal')).hide();
      e.target.reset();
    });

    // initial renders
    renderUsers();
    renderPayments();
    renderMessages();

    // Trade History, Insights, Signals logic can remain from previous script…
  </script>
</body>
</html>
