<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Panel – CBE</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
  <style>
    /* ─── Reset & Base ─── */
    * { margin:0; padding:0; box-sizing:border-box; }
    html, body {
      width:100%; height:100%;
      font-family:'Poppins',sans-serif;
      background:#000; color:#fff;
      overflow-x:hidden;
    }
    a { color: gold; text-decoration: none; }
    a:hover { text-decoration: underline; }

    /* ─── Video Background & Overlay ─── */
    video#bg {
      position: fixed; top:0; left:0;
      width:100%; height:100%;
      object-fit: cover; z-index: -2;
    }
    .overlay {
      position: fixed; top:0; left:0;
      width:100%; height:100%;
      background: rgba(0,0,0,0.6);
      z-index: -1;
    }

    /* ─── Password Modal ─── */
    #pwModal {
      position: fixed; top:0; left:0;
      width:100%; height:100%;
      background: rgba(0,0,0,0.85);
      display:flex; align-items:center; justify-content:center;
      z-index:2000;
    }
    #pwModal .box {
      background:#111; padding:30px; border-radius:8px;
      text-align:center; box-shadow:0 0 20px rgba(255,215,0,0.3);
    }
    #pwModal input {
      width:200px; padding:10px; margin-top:15px;
      border:1px solid #333; border-radius:4px;
      background:#1c1c1c; color:#f5f5f5;
    }
    #pwModal button {
      margin-top:20px; padding:10px 20px;
      background:gold; border:none; color:#000;
      cursor:pointer; border-radius:4px;
    }

    /* ─── Header & Toggle ─── */
    header {
      position: relative; text-align:center;
      padding:20px 0; background:rgba(0,0,0,0.7);
      box-shadow:0 2px 6px rgba(0,0,0,0.5);
    }
    header h1 {
      color: gold; font-size:1.8rem;
    }
    #navToggle {
      position:absolute; top:20px; right:20px;
      width:36px; height:36px; background:gold;
      border:none; border-radius:50%; cursor:pointer;
      animation:blink 2s infinite;
    }
    @keyframes blink {
      0%,100%{box-shadow:0 0 6px gold}
      50%{box-shadow:0 0 18px gold}
    }
    #navToggle span {
      display:block; width:6px; height:6px;
      background:#000; margin:4px auto;
      border-radius:50%;
    }

    /* ─── Nav Dropdown ─── */
    #navDropdown {
      position:absolute; top:70px; right:20px;
      background:rgba(20,20,20,0.9); border-radius:6px;
      overflow:hidden; max-height:0; transition:max-height 0.3s ease;
      z-index:1500; width:200px;
    }
    #navDropdown.active { max-height:600px; }
    #navDropdown a {
      display:block; padding:12px 16px;
      border-bottom:1px solid #333;
      color:gold;
    }
    #navDropdown a:last-child { border-bottom:none; }

    /* ─── Main Content ─── */
    .main {
      padding:100px 30px 30px; max-width:1000px;
      margin:0 auto; position:relative; z-index:1;
    }

    .section {
      background:rgba(20,20,20,0.8); margin-bottom:30px;
      padding:20px; border-radius:8px;
      box-shadow:0 0 15px rgba(255,215,0,0.2);
    }
    .section h2 {
      margin-bottom:15px; color:gold;
    }

    .record-box, .insight-box {
      background:#141414; padding:12px 16px;
      margin-bottom:12px; border-radius:6px;
      position:relative;
    }
    .record-box button, .insight-box button {
      position:absolute; top:12px; right:12px;
      background:crimson; border:none; padding:6px 10px;
      color:#fff; border-radius:4px; cursor:pointer;
    }
  </style>
</head>
<body>

  <!-- Video & Overlay -->
  <video id="bg" autoplay muted loop>
    <source src="star-video.MP4" type="video/mp4"/>
  </video>
  <div class="overlay"></div>

  <!-- Password Modal -->
  <div id="pwModal">
    <div class="box">
      <h3>Enter Admin Password</h3>
      <input type="password" id="adminPw" placeholder="Password"/>
      <br/>
      <button onclick="checkPw()">Unlock</button>
    </div>
  </div>

  <!-- Header & Nav Toggle -->
  <header>
    <h1>CBE Admin Panel</h1>
    <button id="navToggle" onclick="toggleNav()">
      <span></span><span></span><span></span>
    </button>
    <div id="navDropdown">
      <a href="#payments">Payment Records</a>
      <a href="#applications">Applications</a>
      <a href="#users">User Approvals</a>
      <a href="#settings">Settings Sync</a>
      <a href="#vipAccess">VIP Access</a>
      <a href="#broadcast">Broadcast</a>
      <a href="#messages">Inbox Messages</a>
      <a href="#signals">Signal Publishing</a>
      <a href="#history">Trade History</a>
      <a href="#insights">Trade Insights</a>
      <a href="#logs">Log Tracking</a>
    </div>

  <!-- Main Content -->
  <div class="main" id="adminMain">

    <!-- PAYMENT RECORDS -->
    <div class="section" id="payments">
      <h2>Payment Records</h2>
      <div id="paymentContainer"></div>
    </div>

    <!-- APPLICATIONS -->
    <div class="section" id="applications">
      <h2>Application Submissions</h2>
      <div id="applicationContainer"></div>
    </div>

    <!-- USER APPROVALS -->
    <div class="section" id="users">
      <h2>User Management</h2>
      <div id="userContainer"></div>
    </div>
        <!-- SETTINGS SYNC -->
    <div class="section" id="settings">
      <h2>Settings (BTC/ETH/USDT/Paystack)</h2>
      <form id="settingsForm">
        <input type="text" id="btc" placeholder="Bitcoin Address"/><br>
        <input type="text" id="eth" placeholder="Ethereum Address"/><br>
        <input type="text" id="usdt" placeholder="USDT Address"/><br>
        <input type="text" id="paystackKey" placeholder="Paystack Public Key"/><br>
        <button type="submit">Save Settings</button>
      </form>
    </div>

    <!-- VIP ACCESS -->
    <div class="section" id="vipAccess">
      <h2>VIP Access Auto‑Grant</h2>
      <p>Automatically grants VIP status when payment is approved.</p>
    </div>

    <!-- BROADCAST -->
    <div class="section" id="broadcast">
      <h2>Broadcast Message</h2>
      <textarea id="broadcastText" rows="4" style="width:100%;"></textarea>
      <button onclick="broadcastMessage()">Send</button>
    </div>

    <!-- INBOX MESSAGES -->
    <div class="section" id="messages">
      <h2>Inbox Messages</h2>
      <div id="inboxContainer"></div>
    </div>

    <!-- SIGNAL PUBLISHING -->
    <div class="section" id="signals">
      <h2>Signal Publishing</h2>
      <form id="signalForm">
        <input type="text" id="pair" placeholder="Pair (EUR/USD)" required/>
        <input type="text" id="direction" placeholder="BUY or SELL" required/>
        <input type="text" id="entry" placeholder="Entry Price" required/>
        <input type="text" id="tp" placeholder="Take Profit" required/>
        <input type="text" id="sl" placeholder="Stop Loss" required/>
        <input type="date" id="signalDate" required/>
        <input type="time" id="signalTime" required/>
        <textarea id="signalNote" placeholder="Admin Note"></textarea>
        <button type="submit">Publish Signal</button>
      </form>
    </div>

    <!-- TRADE HISTORY -->
    <div class="section" id="history">
      <h2>Trade History</h2>
      <div id="historyContainer"></div>
    </div>

    <!-- TRADE INSIGHTS -->
    <div class="section" id="insights">
      <h2>Trade Insights</h2>
      <div id="insightContainer"></div>
    </div>

    <!-- LOG TRACKING -->
    <div class="section" id="logs">
      <h2>Log Tracking</h2>
      <div id="logContainer"></div>
    </div>

  </div> <!-- /.main -->

  <script>
    // ─── Password Protection ───
    function checkPw() {
      if (document.getElementById('adminPw').value === 'Blessed@123') {
        sessionStorage.setItem('adminAuth','true');
        document.getElementById('pwModal').style.display = 'none';
        initAll();
      } else {
        alert('Incorrect password.');
      }
    }
    if (sessionStorage.getItem('adminAuth')==='true') {
      document.getElementById('pwModal').style.display='none';
      initAll();
    }

    // ─── Nav Toggle ───
    function toggleNav() {
      document.getElementById('navDropdown').classList.toggle('active');
    }

    // ─── Initialization ───
    function initAll() {
      loadPayments();
      loadApplications();
      loadUsers();
      loadSettings();
      loadInbox();
      loadLogs();
      loadSignals();
      loadHistory();
      loadInsights();
    }

    // ─── PAYMENTS ───
    function loadPayments() {
      const r = JSON.parse(localStorage.getItem('paymentRecords')||'[]'),
            c = document.getElementById('paymentContainer');
      c.innerHTML = r.length
        ? r.map((p,i)=>`
            <div class="record-box">
              <p><strong>${p.email}</strong> – ${p.plan}</p>
              <p>Status: ${p.status}</p>
              <button onclick="approvePayment(${i})">Approve</button>
            </div>`).join('')
        : '<p>No payments yet.</p>';
    }
    function approvePayment(i){
      let r=JSON.parse(localStorage.getItem('paymentRecords')),u=JSON.parse(localStorage.getItem('users')||'[]');
      r[i].status='approved'; localStorage.setItem('paymentRecords',JSON.stringify(r));
      const idx=u.findIndex(x=>x.email===r[i].email);
      if(idx>=0){u[idx].status='approved'; localStorage.setItem('users',JSON.stringify(u));}
      loadPayments(); loadUsers();
    }

    // ─── APPLICATIONS ───
    function loadApplications() {
      const a = JSON.parse(localStorage.getItem('applications')||'[]'),
            c = document.getElementById('applicationContainer');
      c.innerHTML = a.length
        ? a.map((app,i)=>`
            <div class="record-box">
              <p><strong>${app.name}</strong> (${app.email})</p>
              <p>Status: ${app.status}</p>
            </div>`).join('')
        : '<p>No applications yet.</p>';
    }

    // ─── USERS ───
    function loadUsers() {
      const u = JSON.parse(localStorage.getItem('users')||'[]'),
            c = document.getElementById('userContainer');
      c.innerHTML = u.length
        ? u.map((usr,i)=>`
            <div class="record-box">
              <p><strong>${usr.name}</strong> (${usr.email})</p>
              <p>Status: ${usr.status}</p>
              <button onclick="approveUser(${i})">Approve</button>
              <button onclick="deactivateUser(${i})">Deactivate</button>
              <button onclick="deleteUser(${i})">Delete</button>
            </div>`).join('')
        : '<p>No users yet.</p>';
    }
    function approveUser(i){let u=JSON.parse(localStorage.getItem('users'));u[i].status='approved';localStorage.setItem('users',JSON.stringify(u));loadUsers();}
    function deactivateUser(i){let u=JSON.parse(localStorage.getItem('users'));u[i].status='inactive';localStorage.setItem('users',JSON.stringify(u));loadUsers();}
    function deleteUser(i){let u=JSON.parse(localStorage.getItem('users'));u.splice(i,1);localStorage.setItem('users',JSON.stringify(u));loadUsers();}

    // ─── SETTINGS ───
    function loadSettings(){
      const s=JSON.parse(localStorage.getItem('paymentSettings')||'{}');
      document.getElementById('btc').value = s.btc||'';
      document.getElementById('eth').value = s.eth||'';
      document.getElementById('usdt').value= s.usdt||'';
      document.getElementById('paystackKey').value = s.paystackKey||'';
    }
    document.getElementById('settingsForm').addEventListener('submit',e=>{
      e.preventDefault();
      const obj={
        btc:document.getElementById('btc').value.trim(),
        eth:document.getElementById('eth').value.trim(),
        usdt:document.getElementById('usdt').value.trim(),
        paystackKey:document.getElementById('paystackKey').value.trim()
      };
      localStorage.setItem('paymentSettings',JSON.stringify(obj));
      alert('Settings saved.');
    });

    // ─── BROADCAST ───
    function broadcastMessage(){
      const msg=document.getElementById('broadcastText').value.trim();
      if(!msg) return alert('Enter a message.');
      localStorage.setItem('broadcastMessage',msg);
      alert('Broadcast saved.');
      document.getElementById('broadcastText').value='';
    }

    // ─── INBOX ───
    function loadInbox(){
      const msgs=JSON.parse(localStorage.getItem('inboxMessages')||'[]'),
            c   =document.getElementById('inboxContainer');
      c.innerHTML = msgs.length
        ? msgs.map(m=>`
            <div class="record-box">
              <p><strong>${m.name}</strong> (${m.email})</p>
              <p>${m.message}</p>
            </div>`).join('')
        : '<p>No messages.</p>';
    }

    // ─── SIGNALS ───
    function loadSignals(){
      const sigs=JSON.parse(localStorage.getItem('vipSignals')||'[]'),
            c   =document.getElementById('signalContainer');
      c.innerHTML = sigs.length
        ? sigs.map((s,i)=>`
            <div class="insight-box">
              <p><strong>${s.date} ${s.time}</strong></p>
              <p>${s.direction} ${s.pair} @ ${s.entry}</p>
              <p>TP: ${s.tp}  SL: ${s.sl}</p>
              <p><em>${s.note}</em></p>
              <button onclick="deleteSignal(${i})">Delete</button>
            </div>`).join('')
        : '<p>No signals published.</p>';
    }
    function deleteSignal(i){let a=JSON.parse(localStorage.getItem('vipSignals')||'[]');
      if(confirm('Delete this signal?')){a.splice(i,1);localStorage.setItem('vipSignals',JSON.stringify(a));loadSignals();}
    }

    // ─── TRADE HISTORY & INSIGHTS ───
    function loadHistory(){
      const a=JSON.parse(localStorage.getItem('tradeHistory')||'[]'),
            c=document.getElementById('historyContainer');
      c.innerHTML = a.length
        ? a.map((h,i)=>`
            <div class="insight-box">
              <img src="${h.image}" alt="History"/>
              <button onclick="deleteHistory(${i})">Delete</button>
              <p><strong>${h.date}</strong></p><p>${h.note}</p>
            </div>`).join('')
        : '<p>No history yet.</p>';
    }
    function deleteHistory(i){let a=JSON.parse(localStorage.getItem('tradeHistory')||'[]');
      if(confirm('Delete this record?')){a.splice(i,1);localStorage.setItem('tradeHistory',JSON.stringify(a));loadHistory();}
    }

    function loadInsights(){
      const a=JSON.parse(localStorage.getItem('tradeInsights')||'[]'),
            c=document.getElementById('insightContainer');
      c.innerHTML = a.length
        ? a.map((it,i)=>`
            <div class="insight-box">
              <img src="${it.image}" alt="Insight"/>
              <button onclick="deleteInsight(${i})">Delete</button>
              <p><strong>${it.date}</strong></p><p>${it.note}</p>
            </div>`).join('')
        : '<p>No insights yet.</p>';
    }
    function deleteInsight(i){let a=JSON.parse(localStorage.getItem('tradeInsights')||'[]');
      if(confirm('Delete this insight?')){a.splice(i,1);localStorage.setItem('tradeInsights',JSON.stringify(a));loadInsights();}
    }

    // ─── LOG TRACKING ───
    function log(msg){
      const arr=JSON.parse(localStorage.getItem('adminLogs')||'[]');
      arr.push(`${new Date().toLocaleString()}: ${msg}`);
      localStorage.setItem('adminLogs',JSON.stringify(arr));
    }
    function loadLogs(){
      const a=JSON.parse(localStorage.getItem('adminLogs')||'[]'),
            c=document.getElementById('logContainer');
      c.innerHTML = a.length
        ? a.map(l=>`<p>${l}</p>`).join('')
        : '<p>No logs yet.</p>';
    }

    // ─── INIT ───
    function initAll(){
      loadPayments(); loadApplications(); loadUsers();
      loadSettings(); loadInbox(); loadSignals();
      loadHistory(); loadInsights(); loadLogs();
    }
    window.addEventListener('load', ()=> {
      if(sessionStorage.getItem('adminAuth')==='true') {
        document.getElementById('navDropdown').style.display='block';
        initAll();
      }
    });
  </script>
</body>
</html>
