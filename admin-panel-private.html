<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" /><meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CBE Admin Panel</title>
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <style>
    body { overflow-x: hidden; }
    #sidebar { width:250px; background:#111; color:#f5f5f5; transition:.3s; }
    #sidebar.collapsed { margin-left:-250px; }
    #sidebar .nav-link { color:#bbb; }
    #sidebar .nav-link.active, #sidebar .nav-link:hover { background:#222; color:#fff; }
    #content { flex:1; padding:1.5rem; transition:.3s; }
    #toggle-btn { cursor:pointer; font-size:1.5rem; }
    .card-stat { color:#fff; }
    .card-stat.bg-primary { background:#4e73df; }
    .card-stat.bg-success { background:#1cc88a; }
    .card-stat.bg-info    { background:#36b9cc; }
    .badge-status { width:80px; text-align:center; }
    input[type=file] { padding:.3rem; }
  </style>
</head>
<body>
  <div class="d-flex">
    <!-- Sidebar -->
    <nav id="sidebar" class="d-flex flex-column">
      <div class="p-3 text-center"><h4>CBE Admin</h4></div>
      <ul class="nav nav-pills flex-column mb-auto" id="menu">
        <li class="nav-item"><a class="nav-link active" data-section="dashboard" href="#">Dashboard</a></li>
        <li class="nav-item"><a class="nav-link" data-section="users" href="#">Users</a></li>
        <li class="nav-item"><a class="nav-link" data-section="payments" href="#">Payments</a></li>
        <li class="nav-item"><a class="nav-link" data-section="messages" href="#">Messages</a></li>
        <li class="nav-item"><a class="nav-link" data-section="settings-payment" href="#">Payment Settings</a></li>
        <li class="nav-item"><a class="nav-link" data-section="trade-history" href="#">Trade History</a></li>
        <li class="nav-item"><a class="nav-link" data-section="trade-insights" href="#">Trade Insights</a></li>
        <li class="nav-item"><a class="nav-link" data-section="signals" href="#">Signals</a></li>
        <li class="nav-item mt-auto"><a class="nav-link text-danger" href="#">Logout</a></li>
      </ul>
    </nav>

    <!-- Main Content -->
    <div id="content" class="d-flex flex-column">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div id="toggle-btn">&#8942;</div>
        <h2 id="section-title">Dashboard</h2>
      </div>

      <div id="sections">
        <!-- Dashboard Stats -->
        <div class="section" data-section="dashboard">
          <div class="row g-4">
            <div class="col-md-3">
              <div class="card card-stat bg-primary p-3">
                <h5>Total Users</h5><h2 id="stat-users">—</h2>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card card-stat bg-success p-3">
                <h5>Pending Payments</h5><h2 id="stat-payments">—</h2>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card card-stat bg-info p-3">
                <h5>Trades This Month</h5><h2 id="stat-trades">—</h2>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card card-stat bg-secondary p-3">
                <h5>Signals Published</h5><h2 id="stat-signals">—</h2>
              </div>
            </div>
          </div>
        </div>

        <!-- Users -->
        <div class="section d-none" data-section="users">
          <h4>Users Verification</h4>
          <input id="user-search" class="form-control mb-2" placeholder="Search users…" />
          <table class="table table-hover">
            <thead><tr><th>Email</th><th>Name</th><th>Status</th><th>Action</th></tr></thead>
            <tbody id="users-table"></tbody>
          </table>
        </div>

        <!-- Payments -->
        <div class="section d-none" data-section="payments">
          <h4>Payment Approval</h4>
          <button id="export-payments" class="btn btn-sm btn-outline-secondary mb-2">Export CSV</button>
          <table class="table table-hover">
            <thead><tr><th>User</th><th>Amount</th><th>Date</th><th>Status</th><th>Action</th></tr></thead>
            <tbody id="payments-table"></tbody>
          </table>
        </div>

        <!-- Messages -->
        <div class="section d-none" data-section="messages">
          <h4>Contact Messages</h4>
          <input id="msg-search" class="form-control mb-2" placeholder="Search messages…" />
          <div class="list-group" id="messages-list"></div>
        </div>

        <!-- Payment Settings -->
        <div class="section d-none" data-section="settings-payment">
          <h4>Payment Settings</h4>
          <ul class="nav nav-pills mb-3">
            <li class="nav-item">
              <button class="nav-link active" data-bs-toggle="pill" data-bs-target="#paystack-tab">Paystack</button>
            </li>
            <li class="nav-item">
              <button class="nav-link" data-bs-toggle="pill" data-bs-target="#crypto-tab">Crypto</button>
            </li>
          </ul>
          <div class="tab-content">
            <!-- Paystack -->
            <div id="paystack-tab" class="tab-pane fade show active">
              <form id="form-paystack">
                <div class="mb-3">
                  <label class="form-label">Public Key</label>
                  <input type="text" class="form-control" id="ps-public" placeholder="pk_live_..." />
                </div>
                <div class="mb-3">
                  <label class="form-label">Secret Key</label>
                  <input type="text" class="form-control" id="ps-secret" placeholder="sk_live_..." />
                </div>
                <button class="btn btn-primary">Save Paystack</button>
              </form>
            </div>
            <!-- Crypto -->
            <div id="crypto-tab" class="tab-pane fade">
              <form id="form-crypto">
                <div class="mb-3"><label>Bitcoin (BTC)</label><input type="text" class="form-control" id="addr-btc" /></div>
                <div class="mb-3"><label>Ethereum (ERC20)</label><input type="text" class="form-control" id="addr-eth" /></div>
                <div class="mb-3"><label>Tron (TRX)</label><input type="text" class="form-control" id="addr-trx" /></div>
                <div class="mb-3"><label>USDT (TRC20)</label><input type="text" class="form-control" id="addr-usdt" /></div>
                <button class="btn btn-primary">Save Crypto</button>
              </form>
            </div>
          </div>
        </div>

        <!-- Trade History -->
        <div class="section d-none" data-section="trade-history">
          <h4>Trade History (Jan – Dec)</h4>
          <div class="row g-2 mb-3">
            <div class="col-md-3">
              <select id="month-select" class="form-select">
                <option value="01">January</option><option value="02">February</option>
                <option value="03">March</option><option value="04">April</option>
                <option value="05">May</option><option value="06">June</option>
                <option value="07">July</option><option value="08">August</option>
                <option value="09">September</option><option value="10">October</option>
                <option value="11">November</option><option value="12">December</option>
              </select>
            </div>
            <div class="col-md-3">
              <input id="trade-search" class="form-control" placeholder="Search trades…" />
            </div>
            <div class="col-auto">
              <button id="export-history" class="btn btn-outline-secondary">Export Month</button>
            </div>
          </div>
          <!-- Upload New Trade -->
          <form id="trade-upload-form" class="border p-3 mb-4">
            <div class="row g-3">
              <div class="col-md-3">
                <label class="form-label">Date</label>
                <input type="date" class="form-control" id="trade-date" />
              </div>
              <div class="col-md-3">
                <label class="form-label">Pair / Asset</label>
                <input list="asset-list" class="form-control" id="trade-pair" placeholder="e.g. GOLD or BTC/USD" />
                <datalist id="asset-list">
                  <option>GOLD</option><option>BTC/USD</option><option>ETH/USD</option>
                  <option>EUR/USD</option><option>USD/JPY</option>
                </datalist>
              </div>
              <div class="col-md-3">
                <label class="form-label">Notes</label>
                <input type="text" class="form-control" id="trade-notes" placeholder="Buy the dip…" />
              </div>
              <div class="col-md-3">
                <label class="form-label">Screenshot</label>
                <input type="file" accept="image/*" class="form-control" id="trade-file" />
              </div>
            </div>
            <div class="mt-3">
              <button class="btn btn-success">Add Trade</button>
            </div>
          </form>
          <!-- Trades Table -->
          <table class="table table-striped">
            <thead><tr><th>Date</th><th>Pair</th><th>Notes</th><th>Screenshot</th></tr></thead>
            <tbody id="history-table"></tbody>
          </table>
        </div>

        <!-- Trade Insights -->
        <div class="section d-none" data-section="trade-insights">
          <h4>Weekly Pips Insights</h4>
          <form id="insights-form" class="row g-3 mb-4">
            <div class="col-md-4"><label>Week Ending</label><input type="date" id="insight-week" class="form-control" /></div>
            <div class="col-md-4"><label>Pips Gained</label><input type="number" id="insight-pips" class="form-control" /></div>
            <div class="col-md-4 align-self-end"><button class="btn btn-success">Post Insight</button></div>
          </form>
          <ul class="list-group" id="insights-list"></ul>
        </div>

        <!-- Signals -->
        <div class="section d-none" data-section="signals">
          <h4>Publish Signals</h4>
          <form id="signals-form" class="border p-3 mb-4">
            <div class="row g-3">
              <div class="col-md-3">
                <label class="form-label">Asset / Pair</label>
                <input list="asset-list" class="form-control" id="signal-asset" placeholder="Type or choose…" />
              </div>
              <div class="col-md-2">
                <label class="form-label">Type</label>
                <select id="signal-type" class="form-select">
                  <option>BUY</option><option>SELL</option>
                </select>
              </div>
              <div class="col-md-2">
                <label class="form-label">SL</label>
                <input type="text" id="signal-sl" class="form-control" placeholder="e.g. 1900" />
              </div>
              <div class="col-md-2">
                <label class="form-label">TP1</label>
                <input type="text" id="signal-tp1" class="form-control" placeholder="e.g. 1920" />
              </div>
              <div class="col-md-2">
                <label class="form-label">TP2</label>
                <input type="text" id="signal-tp2" class="form-control" placeholder="e.g. 1940" />
              </div>
              <div class="col-12">
                <label class="form-label">Notes (Risk & Money Mgmt.)</label>
                <textarea id="signal-note" class="form-control" rows="2"></textarea>
              </div>
            </div>
            <div class="mt-3"><button class="btn btn-primary">Publish Signal</button></div>
          </form>
          <ul class="list-group" id="signals-list"></ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Reply Modal -->
  <div class="modal fade" id="replyModal"><div class="modal-dialog">
    <form class="modal-content" id="reply-form">
      <div class="modal-header">
        <h5 class="modal-title">Reply to Message</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="reply-email"/>
        <div class="mb-3"><label>To</label><input id="reply-to" class="form-control" readonly/></div>
        <div class="mb-3"><label>Message</label><textarea id="reply-body" class="form-control" rows="4"></textarea></div>
      </div>
      <div class="modal-footer"><button class="btn btn-success">Send Reply</button></div>
    </form>
  </div></div>

  <!-- Bootstrap & Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Sidebar toggle & nav
    document.getElementById('toggle-btn').onclick = () => 
      document.getElementById('sidebar').classList.toggle('collapsed');
    document.querySelectorAll('#menu .nav-link').forEach(l => {
      l.onclick = e => {
        e.preventDefault();
        document.querySelectorAll('#menu .nav-link').forEach(x=>x.classList.remove('active'));
        l.classList.add('active');
        let sec=l.dataset.section;
        document.getElementById('section-title').textContent=l.textContent;
        document.querySelectorAll('.section').forEach(s=>
          s.classList.toggle('d-none', s.dataset.section!==sec)
        );
      };
    });

    // Placeholder stores
    let trades = [], insights = [], signals = [];
    let users = [], payments = [], messages = [];

    // Dashboard stats (replace with real fetches)
    document.getElementById('stat-users').textContent = users.length;
    document.getElementById('stat-payments').textContent = payments.filter(p=>p.status==='Pending').length;
    document.getElementById('stat-trades').textContent = trades.filter(t=>t.date.startsWith(new Date().toISOString().slice(0,7))).length;
    document.getElementById('stat-signals').textContent = signals.length;

    // Trade History logic
    const monthSelect=document.getElementById('month-select'),
          tradeForm=document.getElementById('trade-upload-form'),
          histTable=document.getElementById('history-table');
    function renderTrades() {
      let m=monthSelect.value;
      histTable.innerHTML='';
      trades.filter(t=>t.date.slice(5,7)===m).forEach(t=>{
        let tr=document.createElement('tr');
        tr.innerHTML=`
          <td>${t.date}</td>
          <td>${t.pair}</td>
          <td>${t.notes}</td>
          <td>${t.fileName?`<img src="${t.url}" style="height:40px;">`:'—'}</td>`;
        histTable.appendChild(tr);
      });
    }
    tradeForm.onsubmit=e=>{
      e.preventDefault();
      let date=document.getElementById('trade-date').value,
          pair=document.getElementById('trade-pair').value,
          notes=document.getElementById('trade-notes').value,
          fileInput=document.getElementById('trade-file'),
          file=fileInput.files[0];
      let rec={date,pair,notes};
      if(file){
        rec.fileName=file.name;
        rec.url=URL.createObjectURL(file);
      }
      trades.unshift(rec);
      renderTrades();
      e.target.reset();
    };
    monthSelect.onchange=renderTrades;
    renderTrades();

    // Trade Insights & Signals: reuse prior scripts…

    // (You’d implement similar render/add functions for insights, signals, users, payments, messages, tying them to your real APIs.)
  </script>
</body>
</html>
